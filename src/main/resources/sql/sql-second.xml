<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.second.group.mapper.SecondMapper">

	<select id="selectSecondHomeList" resultType="com.second.group.dto.SecondRecipeDto">
		<![CDATA[
			SELECT 
				idx, title, user_user_idx,
			DATE_FORMAT
				(created_datetime, '%Y.%m.%d') 
			AS 
				created_datetime, 
				recipe_cover_img, recipe_file_path
			FROM 
				recipe
			WHERE
			   idx;
		]]>
	</select>
	<select id="selectCommentHomeList" resultType="com.second.group.dto.SecondCommentDto">
		<![CDATA[ 
		SELECT 
			cmtidx, cmt_content, 
		DATE_FORMAT
			(cmt_datetime, '%Y.%m.%d') 
		AS 
			cmt_datetime
		FROM 
			comment
		WHERE
			cmtidx
		
		]]>
	</select>
	<select id="selectSecondList" resultType="com.second.group.dto.SecondRecipeDto">
		<![CDATA[
			SELECT
				idx, created_datetime, title, recommend
			FROM
			    recipe
			WHERE
			    recipe_deleted_yn = 'N'
			ORDER BY idx DESC
		]]>
	</select>
	
	<!-- 회원가입 -->
	<select id="insertSecondJoin" parameterType="com.second.group.dto.SecondUserDto">
		<![CDATA[
			INSERT INTO user 
				(user_id, user_pw, user_phone, user_gender, user_year,
				 user_comment, file_name, stored_file_path)
			VALUES 
				(#{userId}, #{userPw}, #{userPhone}, #{userGender},
				 #{userYear}, #{userComment}, #{fileName}, #{storedFilePath})
		]]>
	</select>
	
	<!-- 아이디 중복체크 -->
	<select id="idCheck" resultType="int">
		<![CDATA[
			SELECT count(*) FROM user WHERE user_id = #{userId}
		]]>
	</select>
	
	<!-- 로그인 -->
	<select id="selectUserInfoYn" parameterType="map" resultType="int">
		<![CDATA[
			SELECT 
				COUNT(*) AS cnt
			FROM 
				user
			WHERE 
				user_id = #{userId}
			AND 
				user_pw = #{userPw}
		]]>
	</select>
	
</mapper>